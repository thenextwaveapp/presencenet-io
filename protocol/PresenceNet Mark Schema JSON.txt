{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "PresenceNet Mark Schema",
  "description": "Schema for a verifiable, cryptographically anchored mark in the PresenceNet protocol.",
  "type": "object",
  "properties": {
    "markId": {
      "type": "string",
      "description": "Unique ID for the mark (UUID or CID)."
    },
    "version": {
      "type": "string",
      "enum": [
        "1.0"
      ],
      "description": "Schema version."
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "UTC timestamp of the mark."
    },
    "witness": {
      "type": "string",
      "description": "Handle of the primary witness."
    },
    "markType": {
      "type": "string",
      "enum": [
        "ritual",
        "self",
        "vault",
        "public"
      ],
      "description": "Type of mark."
    },
    "note": {
      "type": "string",
      "description": "Optional description or reflection."
    },
    "ritual": {
      "type": "object",
      "required": [
        "ritualId",
        "participants",
        "threshold"
      ],
      "properties": {
        "ritualId": {
          "type": "string"
        },
        "participants": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "threshold": {
          "type": "integer"
        }
      }
    },
    "vault": {
      "type": "object",
      "required": [
        "vaultId",
        "signers",
        "requiredSigners"
      ],
      "properties": {
        "vaultId": {
          "type": "string"
        },
        "signers": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "requiredSigners": {
          "type": "integer"
        }
      }
    },
    "location": {
      "type": [
        "string",
        "null"
      ],
      "description": "Optional geolocation or symbolic space."
    },
    "attachments": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Optional list of file CIDs or asset references."
    },
    "signature": {
      "type": "string",
      "description": "Hex-encoded signature for this mark."
    },
    "hash": {
      "type": "string",
      "description": "Hash or CID of the full encrypted mark JSON."
    },
    "encryption": {
      "type": "object",
      "required": [
        "type",
        "sharedWith",
        "keyHash"
      ],
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "aes-256-gcm"
          ]
        },
        "sharedWith": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "keyHash": {
          "type": "string"
        }
      }
    }
  },
  "required": [
    "markId",
    "version",
    "timestamp",
    "witness",
    "markType",
    "signature",
    "hash"
  ]
}